create table hosinsa_notice(
nno number(10,0),
ntitle varchar2(300) not null,
ncontent varchar2(3000) not null,
id varchar2(30) not null,
nwritedate date default sysdate,
nupdatedate date default sysdate
);


create table hosinsa_notice(
nno number(10,0),
ntitle varchar2(300) not null,
ncontent varchar2(3000) not null,
id varchar2(30) not null,
nwritedate date default sysdate,
nupdatedate date default sysdate,
ncnt number(8) default 0
);


alter table hosinsa_notice add constraint pk_notice
primary key(nno);


drop SEQUENCE seq_notice;
drop table hosinsa_notice;

create SEQUENCE seq_notice;

insert into hosinsa_notice(nno, ntitle, ncontent, id)
values(SEQ_NOTICE.NEXTVAL, '테스트제목1', '테스트 내용1', 'AAA');
insert into hosinsa_notice(nno, ntitle, ncontent, id)
values(SEQ_NOTICE.NEXTVAL, '테스트제목2', '테스트 내용2', 'BBB');
insert into hosinsa_notice(nno, ntitle, ncontent, id)
values(SEQ_NOTICE.NEXTVAL, '테스트제목3', '테스트 내용3', 'CCC');
insert into hosinsa_notice(nno, ntitle, ncontent, id)
values(SEQ_NOTICE.NEXTVAL, '테스트제목4', '테스트 내용4', 'DDD');
insert into hosinsa_notice(nno, ntitle, ncontent, id)
values(SEQ_NOTICE.NEXTVAL, '테스트제목5', '테스트 내용5', 'EEE');

commit;


SELECT * FROM USER_SEQUENCES;

select * from hosinsa_notice;

select*from hosinsa_notice where nno >0;

insert into HOSINSA_NOTICE (nno, ntitle, ncontent, id)
(select seq_notice.nextval, ntitle, ncontent, id from HOSINSA_NOTICE);

select count(*)from hosinsa_notice;

-------------------------------------------------------------------------------------------------------

create SEQUENCE seq_qna;

create table hosinsa_qna(
qno number(10,0),
qcategory varchar2(20) not null,
qtitle varchar2(300) not null,
qcontent varchar2(3000) not null,
id varchar2(30) not null,
qwritedate date default sysdate
);

alter table hosinsa_qna add constraint pk_qna
primary key(qno);

insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
values(SEQ_qna.NEXTVAL, '상품문의', '테스트제목1', '테스트 내용1', 'AAA');
insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
values(SEQ_qna.NEXTVAL, '배송문의', '테스트제목2', '테스트 내용2', 'AAA');
insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
values(SEQ_qna.NEXTVAL, '기타문의', '테스트제목3', '테스트 내용3', 'AAA');
insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
values(SEQ_qna.NEXTVAL, '상품문의', '테스트제목4', '테스트 내용4', 'AAA');
insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
values(SEQ_qna.NEXTVAL, '기타문의', '테스트제목5', '테스트 내용5', 'AAA');

commit;

select * from hosinsa_qna;

insert into hosinsa_qna(qno, qcategory, qtitle, qcontent, id)
(select SEQ_QNA.NEXTVAL, qcategory, qtitle, qcontent, id from HOSINSA_QNA);

select count(*)from HOSINSA_QNA;

commit;

--------------------------------------------------------------------------------------------------------------

고객센터 댓글

create table hosinsa_reply(
rno number(10,0),
qno number(10,0) not null,
reply varchar2(1000) not null,
replyer varchar2(50) not null,
replyDate date default sysdate,
updateDate date default sysdate
);

create sequence seq_reply;

alter table hosinsa_reply add constraint pk_reply primary key(rno);

alter table hosinsa_reply add constraint fk_reply_qna
foreign key (qno) references hosinsa_qna (qno);

select * from hosinsa_reply order by rno desc;

select * from hosinsa_reply;

create index idx_reply on hosinsa_reply (qno desc, rno asc);

 select /*+index(hosinsa_reply idx_reply) */
   		rownum rn, qno, rno, reply, replyer, replydate, updatedate
   		from hosinsa_reply
   		where qno = 406
        and rno >0; 
        
alter table hosinsa_qna add(replycnt number default 0);

update HOSINSA_QNA set REPLYCNT = (select count(rno) from hosinsa_reply
where hosinsa_reply.qno = hosinsa_qna.qno);

